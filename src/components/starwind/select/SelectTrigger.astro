---
import type { HTMLAttributes } from "astro/types";
import { Icon } from "astro-icon/components";
import { tv, type VariantProps } from "tailwind-variants";

type Props = Omit<HTMLAttributes<"button">, "role" | "type"> &
  VariantProps<typeof selectTrigger> & {
    /**
     * The content to be rendered inside the select trigger
     */
    // biome-ignore lint/suspicious/noExplicitAny: Ignore type any set here. Children will have correct types.
    children: any;
  };

export const selectTrigger = tv({
  base: [
    "starwind-select-trigger",
    "border-input dark:bg-input/30 text-foreground ring-offset-background flex items-center justify-between gap-2 rounded-md border bg-transparent shadow-xs",
    "focus-visible:border-focus focus-visible:ring-focus/50 transition-[color,box-shadow] outline-none focus-visible:ring-4",
    "disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",
    "aria-invalid:border-error aria-invalid:focus:ring-error/40 aria-invalid:focus:ring-4",
  ],
  variants: {
    size: {
      sm: "h-9 px-2 text-sm",
      md: "h-11 px-3 text-base",
      lg: "h-12 px-4 text-lg",
    },
  },
  defaultVariants: {
    size: "md",
  },
});

const { class: className, size, ...rest } = Astro.props;
---

<button
  class={selectTrigger({ size, class: className })}
  type="button"
  role="combobox"
  aria-label="Select field"
  aria-controls=""
  aria-expanded="false"
  aria-haspopup="listbox"
  aria-autocomplete="none"
  data-state="closed"
  data-slot="select-trigger"
  {...rest}
>
  <slot />
  <slot name="icon">
    <Icon name="ChevronDown" class="size-4 opacity-50" />
  </slot>
</button>
